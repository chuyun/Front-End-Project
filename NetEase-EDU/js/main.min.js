function closeTip(){var tipClose=document.getElementById("tip-close");addFunc(tipClose,"click",function(){hideTip();setCookie("tipCookie","tipCookieValue",30)})}addLoadEvent(closeTip);function checkCookie(){if(getCookie().tipCookie){console.log(getCookie().tipCookie);hideTip()}if(getCookie().loginSuccess&&getCookie().followSuccess){console.log(getCookie().loginSuccess);console.log(getCookie().followSuccess);hideFollow();showFollowSuccess()}}addFunc(window,"unbeforeunload",checkCookie());function hideTip(){var tip=document.getElementById("tip");tip.style.display="none";var message=document.getElementsByClassName("prompt-message")[0];message.style.display="none"}function login(){var follow=document.getElementById("follow");addFunc(follow,"click",function(){if(!getCookie().loginSuccess){showLoginPop();var loginclose=document.getElementById("login-close");addFunc(loginclose,"click",function(){if(validate()){ajax(url="http://study.163.com/webDev/login.htm",data={userName:md5("studyOnline"),password:md5("study.163.com")},method="get",success=function(res){if(res==1){closeLoginPop();setCookie("loginSuccess","loginSUccessValue",30);console.log(getCookie().loginSuccess);ajax(url="http://study.163.com/webDev/ attention.htm",method="get",success=function(res){alert("关注："+res);if(res==1){hideFollow();showFollowSuccess();setCookie("followSuccess","followSuccessValue",30)}})}},error=function(){alert("登陆错误，请重新登陆")})}})}else{ajax(url="http://study.163.com/webDev/ attention.htm",data={},method="get",success=function(){hideFollow();showFollowSuccess();setCookie("followSuccess","followSuccessValue",30)})}});function validate(){var userName=document.getElementById("userName").value,password=document.getElementById("password").value;if(userName==null||userName==""){alert("请输入用户名")}if(password==null||password==""){alert("请输入密码")}if(userName=="studyOnline"&&password=="study.163.com"){return true}else{alert("请输入正确的用户名和密码")}}function showLoginPop(){document.getElementById("mask").style.display="block";document.getElementById("login").style.display="block"}function closeLoginPop(){document.getElementById("mask").style.display="none";document.getElementById("login").style.display="none"}function hideFollow(){var follow=document.getElementById("follow");follow.style.display="none"}function showFollowSuccess(){var followSuccess=document.getElementById("followSuccess");followSuccess.style.display="block"}}addLoadEvent(login);function carousel(){var currentIndex=0,bannerArr=getElementByClassName("banner-list")[0].getElementsByTagName("li"),bannerLen=bannerArr.length,indexListArr=document.getElementById("indexList").getElementsByTagName("li");autoChange=setInterval(function(){if(currentIndex<bannerLen-1){currentIndex++}else{currentIndex=0}changeTo(currentIndex)},5e3);addEvent();function addEvent(){for(var i=0;i<bannerLen;i++){(function(j){addFunc(indexListArr[j],"click",function(){changeTo(j);currentIndex=j})})(i);(function(j){addFunc(bannerArr[j],"mouseover",function(){clearTimeout(autoChange);currentIndex=j});addFunc(bannerArr[j],"mouseout",function(){autoChange=setInterval(function(){if(currentIndex<bannerLen-1){currentIndex++}else{currentIndex=0}changeTo(currentIndex)},5e3)})})(i)}}function changeTo(num){var currentBanner=document.getElementsByClassName("bannerOn")[0];fadeOut(currentBanner);removeClass(currentBanner,"bannerOn");addClass(bannerArr[num],"bannerOn");fadeIn(bannerArr[num]);var currentIndexOn=document.getElementsByClassName("indexOn")[0];removeClass(currentIndexOn,"indexOn");addClass(indexListArr[num],"indexOn")}function fadeIn(elem){setOpacity(elem,0);for(var i=0;i<=20;i++){(function(){var level=i*5;setTimeout(function(){setOpacity(elem,level)},i*25)})(i)}}function fadeOut(elem){for(var i=0;i<=20;i++){(function(){var level=100-i*5;setTimeout(function(){setOpacity(elem,level)},i*25)})(i)}}function setOpacity(elem,level){if(elem.filters){elem.style.filter="alpha(opacity="+level+")"}else{elem.style.opacity=level/100}}}addLoadEvent(carousel);function videoPlay(){var videoImage=document.getElementById("video-image"),videoClose=document.getElementById("video-close");addFunc(videoImage,"click",function(){showVideoPop()});addFunc(videoClose,"click",function(){hideVideoPop()});function showVideoPop(){document.getElementById("mask").style.display="block";document.getElementById("video-pop").style.display="block"}function hideVideoPop(){document.getElementById("mask").style.display="none";var video=document.getElementById("video");video.pause();document.getElementById("video-pop").style.display="none"}}addLoadEvent(videoPlay);function showHotList(){var returnData=null,elementLi="",num=0,elementUl=document.getElementById("hotlistul");function creatNode(opt){return'<img src="'+opt.smallPhotoUrl+'" alt="'+opt.name+'" class="hotListPic"><div><p class="hotListTitle">'+opt.name+'</p><span class="hotListUserCount">'+opt.learnerCount+"</span></div>"}ajax(url="http://study.163.com/webDev/hotcouresByCategory.htm",data={},method="get",success=function(res){returnData=JSON.parse(res);console.log(returnData);for(var i=0;i<10;i++){elementLi+='<li class="hotListLi">'+creatNode(returnData[i])+"</li>"}elementUl.innerHTML=elementLi},error=function(){alert("ERROR")})}addLoadEvent(showHotList);function initCourse(pageNo,psize,ptype){var rootDom=document.getElementsByClassName("course");function segment(opt){return'<li class="courseLi"><div class="img"><img src="'+opt.middlePhotoUrl+'"></div><div class="title">'+opt.name+'</div><div class="orgName">'+opt.provider+'</div><span class="hot">'+opt.learnerCount+'</span><div class="discount">¥ <span>'+opt.price+"</span></div>"+'<div class="detail-dialog"><div class="uHead"><img src="'+opt.middlePhotoUrl+'" class="pic"><div class="uInfo"><h3 class="uTit">'+opt.name+'</h3><div class="uHot"><span class="uNum">'+opt.learnerCount+'</span>人在学</div><div class="uPub">发布者：<span class="uOri">'+opt.provider+'</span></div><div class="uCategory">分类：<span class="uTag">'+opt.categoryName+'</span></div></div></div><div class="uIntro">'+opt.description+"</div></div></li>"}function courseRender(arr,num){var courseTemple="";for(var i=0;i<num;i++){courseTemple+=segment(arr[i])}console.log("courseTemple:");console.log(courseTemple);rootDom[0].innerHTML=courseTemple}ajax(url="http://study.163.com/webDev/couresByCategory.htm",data={pageNo:pageNo,psize:psize,type:ptype},method="get",success=function(res){var result=JSON.parse(res);courseRender(result.list,result.pagination.pageSize);pagination(result,courseRender,ptype,psize);showCourse()})}function pagination(data,render,courseType,size){var paginationDom=document.getElementsByClassName("pagination"),paginationList=null,prevBtn=null,nextBtn=null,index=1;function reCourse(n){ajax(url="http://study.163.com/webDev/couresByCategory.htm",data={pageNo:n,psize:size,type:courseType},method="get",success=function(res){var result=JSON.parse(res);render(result.list,result.pagination.pageSize);showCourse()});for(var i=1;i<paginationList.length-1;i++){removeClass(paginationList[i],"on")}addClass(paginationList[n],"on")}paginationList=document.getElementsByClassName("ele");prevBtn=paginationList[0];nextBtn=paginationList[paginationList.length-1];addClass(paginationList[1],"on");addFunc(prevBtn,"click",function(){if(index>1){reCourse(--index)}});addFunc(nextBtn,"click",function(){if(index<8){reCourse(++index)}});for(var i=1;i<paginationList.length-1;i++){paginationList[i].id=i;addFunc(paginationList[i],"click",function(){index=this.id;reCourse(this.id)})}}function showCourse(){var courseCell=document.getElementsByClassName("courseLi");for(var i=0;i<courseCell.length;i++){addFunc(courseCell[i],"mouseover",function(){var dialog=this.getElementsByClassName("detail-dialog")[0];dialog.style.display="block"});addFunc(courseCell[i],"mouseout",function(){var dialog=this.getElementsByClassName("detail-dialog")[0];dialog.style.display="none"})}}function tabSwitch(size){var productBtn=document.getElementsByClassName("product")[0];var programBtn=document.getElementsByClassName("program")[0];var data=null;addFunc(productBtn,"click",function(){if(hasClass(programBtn,"current")){removeClass(programBtn,"current");addClass(productBtn,"current");initCourse(1,size,10)}});addFunc(programBtn,"click",function(){if(hasClass(productBtn,"current")){removeClass(productBtn,"current");addClass(programBtn,"current");initCourse(1,size,20)}});initCourse(1,size,10)}function mainContent(){if(document.body.clientWidth>=1205){tabSwitch(20)}else{tabSwitch(15)}}addLoadEvent(mainContent);